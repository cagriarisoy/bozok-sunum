<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yozgat Bozok Ãœniversitesi - Bilgisayar MÃ¼h. (KalÄ±cÄ± V8)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- SheetJS (Excel Okuma) -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        .chart-path { stroke-dasharray: 1000; stroke-dashoffset: 1000; animation: drawLine 2s ease-out forwards; }
        @keyframes drawLine { to { stroke-dashoffset: 0; } }

        /* --- YAZDIRMA AYARLARI --- */
        @media print {
            @page { margin: 0; size: landscape; }
            body { background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .no-print, button, input, .control-buttons { display: none !important; }
            ::-webkit-scrollbar { display: none; }
            #root > div { height: auto !important; overflow: visible !important; position: static !important; }
            .slide-container {
                position: relative !important; inset: auto !important; opacity: 1 !important; z-index: 1 !important;
                display: flex !important; height: 100vh !important; width: 100vw !important;
                page-break-after: always; break-after: page; overflow: hidden !important; padding: 0 !important; background: white !important;
            }
            .slide-content { padding-top: 2rem !important; justify-content: center !important; }
            .header-bar { position: absolute; top: 0; left: 0; width: 100%; z-index: 50; background: white; border-bottom: 1px solid #ddd; }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        // --- Ä°KONLAR ---
        const IconBase = ({ children, size = 24, className = "" }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>);
        const ChevronLeft = (p) => <IconBase {...p}><path d="m15 18-6-6 6-6"/></IconBase>;
        const ChevronRight = (p) => <IconBase {...p}><path d="m9 18 6-6-6-6"/></IconBase>;
        const Users = (p) => <IconBase {...p}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>;
        const BookOpen = (p) => <IconBase {...p}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>;
        const Award = (p) => <IconBase {...p}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></IconBase>;
        const Briefcase = (p) => <IconBase {...p}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></IconBase>;
        const GraduationCap = (p) => <IconBase {...p}><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></IconBase>;
        const Mail = (p) => <IconBase {...p}><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></IconBase>;
        const Globe = (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></IconBase>;
        const TrendingUp = (p) => <IconBase {...p}><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></IconBase>;
        const Target = (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></IconBase>;
        const CheckCircle = (p) => <IconBase {...p}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>;
        const Upload = (p) => <IconBase {...p}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></IconBase>;
        const Printer = (p) => <IconBase {...p}><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></IconBase>;
        const Calendar = (p) => <IconBase {...p}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></IconBase>;

        // ==============================================================================================
        // ðŸ› ï¸ BAÅžLANGIÃ‡ VERÄ°SÄ°
        // ==============================================================================================
        const INITIAL_DATA = {
          department: {
            university: "Yozgat Bozok Ãœniversitesi",
            name: "Bilgisayar MÃ¼hendisliÄŸi",
            year: "2025-2026",
            presentationTitle: "BÃ¶lÃ¼m TanÄ±tÄ±mÄ± ve Akademik Faaliyetler",
            stats: { studentCount: 501, academicStaff: 0, labCount: 4, foundedYear: 2008 },
            vision: "Veri YÃ¼kleyiniz...",
            mission: "Veri YÃ¼kleyiniz...",
            performanceHistory: [],
            publicationStats: { totalCount: 0, breakdown: [], yearlyTrend: [] },
            projectStats: []
          },
          faculty: []
        };

        const STORAGE_KEY = "yobu_presentation_data";

        // ==============================================================================================
        // ðŸŽ¨ BÄ°LEÅžENLER
        // ==============================================================================================
        const { useState, useEffect, useRef } = React;

        const SlideContainer = ({ children, active }) => (
          <div className={`slide-container absolute inset-0 transition-opacity duration-500 overflow-y-auto overflow-x-hidden ${active ? 'opacity-100 z-10' : 'opacity-0 z-0 pointer-events-none'}`}>
            <div className="slide-content min-h-full w-full flex flex-col items-center justify-center py-20 md:py-8">{children}</div>
          </div>
        );

        const StatCard = ({ icon: Icon, value, label, color }) => (
          <div className="bg-white rounded-xl shadow-lg p-6 flex items-center space-x-4 border-l-4 border-red-600 transform hover:scale-105 transition-transform duration-300 w-full">
            <div className={`p-3 rounded-full ${color} shrink-0`}><Icon size={24} className="text-white md:w-7 md:h-7" /></div>
            <div><div className="text-2xl md:text-3xl font-bold text-gray-800">{value}</div><div className="text-xs md:text-sm text-gray-500 uppercase tracking-wide font-semibold">{label}</div></div>
          </div>
        );

        const ProgressBar = ({ label, value, max, colorClass }) => (
          <div className="mb-4">
            <div className="flex justify-between mb-1"><span className="text-xs md:text-sm font-medium text-gray-700 truncate pr-2">{label}</span><span className="text-xs md:text-sm font-medium text-gray-700">{value}</span></div>
            <div className="w-full bg-gray-200 rounded-full h-2.5"><div className={`h-2.5 rounded-full ${colorClass}`} style={{ width: `${Math.min((value / (max || 1)) * 100, 100)}%` }}></div></div>
          </div>
        );

        const MetricBadge = ({ label, value, icon: Icon, color }) => (
          <div className={`flex items-center gap-1 md:gap-2 px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-bold border ${color}`}>
            <Icon size={12} className="md:w-3.5 md:h-3.5" /><span>{label}: {value}</span>
          </div>
        );

        const AreaChart = ({ data }) => {
            if (!data || data.length === 0) return <div>Veri Yok</div>;
            const height = 200, width = 500, padding = 20;
            const maxVal = Math.max(...data.map(d => d.count)) || 10;
            const points = data.map((d, i) => {
                const x = padding + (i / (data.length - 1)) * (width - 2 * padding);
                const y = height - padding - (d.count / maxVal) * (height - 2 * padding);
                return { x, y, val: d.count, year: d.year };
            });
            const linePath = `M ${points.map(p => `${p.x},${p.y}`).join(' L ')}`;
            const areaPath = `${linePath} L ${points[points.length-1].x},${height-padding} L ${points[0].x},${height-padding} Z`;

            return (
                <div className="w-full h-64 relative">
                    <svg viewBox={`0 0 ${width} ${height}`} className="w-full h-full overflow-visible">
                        <line x1={padding} y1={height-padding} x2={width-padding} y2={height-padding} stroke="#e5e7eb" strokeWidth="1" />
                        <line x1={padding} y1={padding} x2={width-padding} y2={padding} stroke="#e5e7eb" strokeWidth="1" strokeDasharray="4" />
                        <defs><linearGradient id="gradient" x1="0" x2="0" y1="0" y2="1"><stop offset="0%" stopColor="#3b82f6" stopOpacity="0.4" /><stop offset="100%" stopColor="#3b82f6" stopOpacity="0.0" /></linearGradient></defs>
                        <path d={areaPath} fill="url(#gradient)" />
                        <path d={linePath} fill="none" stroke="#2563eb" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className="chart-path" />
                        {points.map((p, i) => (
                            <g key={i}>
                                <circle cx={p.x} cy={p.y} r="4" fill="white" stroke="#2563eb" strokeWidth="2" />
                                <text x={p.x} y={p.y - 10} textAnchor="middle" fontSize="12" fill="#1f2937" fontWeight="bold">{p.val}</text>
                                <text x={p.x} y={height - 2} textAnchor="middle" fontSize="10" fill="#6b7280">{p.year}</text>
                            </g>
                        ))}
                    </svg>
                </div>
            );
        };

        function Presentation() {
          // --- STATE BAÅžLANGICINDA LOCALSTORAGE KONTROLÃœ ---
          const [data, setData] = useState(() => {
              const savedData = localStorage.getItem(STORAGE_KEY);
              return savedData ? JSON.parse(savedData) : INITIAL_DATA;
          });
          
          const [currentSlide, setCurrentSlide] = useState(0);
          
          // EÄŸer LocalStorage'da veri varsa direkt sunum moduna geÃ§ (loaded=true)
          const [loaded, setLoaded] = useState(() => {
              return !!localStorage.getItem(STORAGE_KEY);
          });

          const fileInputRef = useRef(null);
          const staticSlidesCount = 5; 
          const totalSlides = staticSlidesCount + data.faculty.length;

          const nextSlide = () => setCurrentSlide((prev) => (prev + 1) % totalSlides);
          const prevSlide = () => setCurrentSlide((prev) => (prev - 1 + totalSlides) % totalSlides);

          useEffect(() => {
            const handleKeyDown = (e) => { if (e.key === 'ArrowRight') nextSlide(); if (e.key === 'ArrowLeft') prevSlide(); };
            window.addEventListener('keydown', handleKeyDown);
            return () => window.removeEventListener('keydown', handleKeyDown);
          }, [totalSlides]);

          const handlePrint = () => { window.print(); };

          // VERÄ°YÄ° SIFIRLAMA FONKSÄ°YONU
          const handleReset = () => {
              if (confirm("KayÄ±tlÄ± veriler silinecek ve varsayÄ±lana dÃ¶nÃ¼lecek. OnaylÄ±yor musunuz?")) {
                  localStorage.removeItem(STORAGE_KEY);
                  window.location.reload();
              }
          };

          const handleFileUpload = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (evt) => {
                const bstr = evt.target.result;
                const workbook = XLSX.read(bstr, { type: 'binary' });
                
                let generalData = workbook.SheetNames.includes('Genel') ? XLSX.utils.sheet_to_json(workbook.Sheets['Genel']) : [];
                let personnelData = [];
                const pSheetName = workbook.SheetNames.includes('Personel') ? 'Personel' : workbook.SheetNames[0];
                personnelData = XLSX.utils.sheet_to_json(workbook.Sheets[pSheetName]);

                let performanceData = [];
                if (workbook.SheetNames.includes('Performans')) performanceData = XLSX.utils.sheet_to_json(workbook.Sheets['Performans']);
                else if (workbook.SheetNames.length > 1) performanceData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[1]]);

                if (personnelData.length > 0) processAllData(generalData, personnelData, performanceData);
                else alert("Personel verisi bulunamadÄ±.");
            };
            reader.readAsBinaryString(file);
          };

          const processAllData = (generalList, personnelList, performanceList) => {
            const targetYears = [2023, 2024, 2025];
            const config = {};
            generalList.forEach(row => { if(row['Alan'] && row['Deger']) config[row['Alan']] = row['Deger']; });

            let totalCitations = 0;
            let pubTypes = { sci: 0, tr: 0, conf: 0, book: 0 };
            let yearlyAgg = {};
            targetYears.forEach(y => { yearlyAgg[y] = { articles: 0, citations: 0, projects: 0, t1001: 0, t1002: 0, t2209: 0, t3501: 0, bap: 0, cost: 0, sayzek: 0, other: 0 }; });

            const newFaculty = personnelList.map((pRow, index) => {
                const personName = pRow['Ad Soyad'] || "Ä°simsiz";
                const person = {
                    id: index + 100,
                    name: personName,
                    title: pRow['Unvan'] || "",
                    email: pRow['Email'] || "",
                    website: pRow['Web'] || "",
                    image: pRow['Resim URL'] || "https://via.placeholder.com/150",
                    metrics: { hIndex: Number(pRow['H-Index']) || 0, totalCitations: Number(pRow['Toplam AtÄ±f']) || 0 },
                    adminDuties: pRow['Ä°dari GÃ¶revler'] ? String(pRow['Ä°dari GÃ¶revler']).split(',') : [],
                    courses: pRow['Dersler'] ? String(pRow['Dersler']).split(',') : [],
                    futureGoals: pRow['Hedefler'] ? String(pRow['Hedefler']).split(',') : [],
                };

                totalCitations += person.metrics.totalCitations;
                const personPerfRows = performanceList.filter(row => row['Ad Soyad'] && row['Ad Soyad'].trim().toLowerCase() === personName.trim().toLowerCase());

                const yearlyPubs = [];

                person.projectsByYear = targetYears.map(year => {
                    const yRow = personPerfRows.find(r => r['Yil'] == year) || {};
                    const vals = {
                        t1001: Number(yRow['1001']) || 0, t1002: Number(yRow['1002']) || 0, t2209: Number(yRow['2209']) || 0,
                        t3501: Number(yRow['3501']) || 0, bap: Number(yRow['BAP']) || 0, cost: Number(yRow['COST']) || 0,
                        sayzek: Number(yRow['SAYZEK']) || 0, other: Number(yRow['Diger']) || 0, 
                        sci: Number(yRow['SCI']) || 0, tr: Number(yRow['TR_Dizin']) || 0, 
                        conf: Number(yRow['Bildiri']) || 0, book: Number(yRow['Kitap']) || 0,
                        citations: Number(yRow['Atif']) || 0
                    };
                    const totalArticles = vals.sci + vals.tr + vals.conf + vals.book;
                    const subTotalProj = vals.t1001 + vals.t1002 + vals.t2209 + vals.t3501 + vals.bap + vals.cost + vals.sayzek + vals.other;

                    yearlyAgg[year].t1001 += vals.t1001; yearlyAgg[year].t1002 += vals.t1002; yearlyAgg[year].t2209 += vals.t2209;
                    yearlyAgg[year].t3501 += vals.t3501; yearlyAgg[year].bap += vals.bap; yearlyAgg[year].cost += vals.cost;
                    yearlyAgg[year].sayzek += vals.sayzek; yearlyAgg[year].other += vals.other; yearlyAgg[year].projects += subTotalProj;
                    yearlyAgg[year].articles += totalArticles; yearlyAgg[year].citations += vals.citations;
                    
                    pubTypes.sci += vals.sci; pubTypes.tr += vals.tr; pubTypes.conf += vals.conf; pubTypes.book += vals.book;

                    if (totalArticles > 0) yearlyPubs.push({ year: year, sci: vals.sci, tr: vals.tr, conf: vals.conf, book: vals.book, total: totalArticles });

                    return { year, tubitak: vals.t1001+vals.t1002+vals.t2209+vals.t3501, bap: vals.bap, cost: vals.cost, sayzek: vals.sayzek, other: vals.other };
                });

                person.yearlyPubs = yearlyPubs;
                person.tubitakDetailsByYear = targetYears.map(year => {
                    const yRow = personPerfRows.find(r => r['Yil'] == year) || {};
                    return { year, t1001: Number(yRow['1001'])||0, t1002: Number(yRow['1002'])||0, t2209: Number(yRow['2209'])||0, t3501: Number(yRow['3501'])||0 };
                });
                return person;
            });

            const performanceHistory = targetYears.map(year => ({ year, articles: yearlyAgg[year].articles, citations: yearlyAgg[year].citations, projects: yearlyAgg[year].projects }));
            const projectStats = targetYears.map(year => ({ year, t1001: yearlyAgg[year].t1001, t1002: yearlyAgg[year].t1002, t2209: yearlyAgg[year].t2209, bap: yearlyAgg[year].bap, cost: yearlyAgg[year].cost, sayzek: yearlyAgg[year].sayzek, total: yearlyAgg[year].projects }));
            const totalPubCount = pubTypes.sci + pubTypes.tr + pubTypes.conf + pubTypes.book;
            
            const newData = {
                department: {
                    ...data.department,
                    university: config['Universite'] || data.department.university,
                    name: config['Bolum'] || data.department.name,
                    year: config['Donem'] || data.department.year,
                    presentationTitle: config['Sunum_Basligi'] || data.department.presentationTitle,
                    vision: config['Vizyon'] || data.department.vision,
                    mission: config['Misyon'] || data.department.mission,
                    stats: {
                        studentCount: config['Ogrenci_Sayisi'] || data.department.stats.studentCount,
                        labCount: config['Lab_Sayisi'] || data.department.stats.labCount,
                        foundedYear: config['Kurulus_Yili'] || data.department.stats.foundedYear,
                        academicStaff: newFaculty.length
                    },
                    performanceHistory: performanceHistory,
                    publicationStats: {
                        totalCount: totalPubCount,
                        breakdown: [
                            { label: "SCI / SCI-E Makaleler", value: pubTypes.sci, max: totalPubCount, color: "bg-blue-600" },
                            { label: "TR-Dizin ve Ulusal", value: pubTypes.tr, max: totalPubCount, color: "bg-blue-500" },
                            { label: "Bildiriler", value: pubTypes.conf, max: totalPubCount, color: "bg-blue-400" },
                            { label: "Kitap / BÃ¶lÃ¼m", value: pubTypes.book, max: totalPubCount, color: "bg-blue-300" }
                        ],
                        yearlyTrend: targetYears.map(y => ({ year: y, count: yearlyAgg[y].articles })) 
                    },
                    projectStats: projectStats
                },
                faculty: newFaculty
            };

            // LOCALSTORAGE KAYDETME
            localStorage.setItem(STORAGE_KEY, JSON.stringify(newData));
            
            setData(newData);
            setLoaded(true);
            alert("Veriler yÃ¼klendi ve tarayÄ±cÄ±ya kaydedildi!");
          };

          if (!loaded) {
              return (
                  <div className="h-screen w-full flex flex-col items-center justify-center bg-gray-100 p-4">
                      <div className="bg-white p-8 rounded-2xl shadow-2xl text-center max-w-lg w-full">
                          <div className="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6"><Upload size={40} /></div>
                          <h1 className="text-2xl font-bold text-gray-800 mb-2">Excel Verisi YÃ¼kleyin</h1>
                          <p className="text-gray-500 mb-6 text-sm">3 SayfalÄ± (Genel, Personel, Performans) Excel dosyasÄ±nÄ± yÃ¼kleyiniz.</p>
                          <input type="file" accept=".xlsx, .xls" ref={fileInputRef} onChange={handleFileUpload} className="hidden" />
                          <button onClick={() => fileInputRef.current.click()} className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-xl transition-colors shadow-lg flex items-center justify-center gap-2">Dosya SeÃ§ ve YÃ¼kle</button>
                      </div>
                  </div>
              );
          }

          return (
            <div className="h-screen w-full bg-gradient-to-br from-gray-50 to-gray-200 text-gray-800 font-sans overflow-hidden relative selection:bg-red-100 fixed top-0 left-0">
              <div className="header-bar absolute top-0 left-0 w-full p-4 md:p-6 flex justify-between items-center z-50 bg-white/80 backdrop-blur-sm md:bg-transparent">
                <div className="flex items-center gap-2 md:gap-3">
                  <div className="w-10 h-10 md:w-12 md:h-12 bg-red-700 rounded-full flex items-center justify-center text-white font-bold text-lg md:text-xl shadow-md shrink-0">YB</div>
                  <div><h1 className="text-sm md:text-lg font-bold text-gray-900 leading-tight">{data.department.university}</h1><p className="text-xs md:text-sm text-gray-600">{data.department.name}</p></div>
                </div>
                <div className="flex items-center gap-3 no-print">
                    <button onClick={handlePrint} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs md:text-sm shadow-md transition-colors"><Printer size={16}/><span className="hidden md:inline">YazdÄ±r</span></button>
                    <button onClick={handleReset} className="text-xs text-red-600 font-bold hover:underline">SÄ±fÄ±rla</button>
                    <div className="text-xs md:text-sm text-gray-500 font-mono bg-white px-2 md:px-3 py-1 rounded-full shadow-sm whitespace-nowrap">{currentSlide + 1} / {totalSlides}</div>
                </div>
              </div>

              <div className="relative w-full h-full max-w-7xl mx-auto">
                <SlideContainer active={currentSlide === 0}>
                  <div className="text-center animate-fade-in-up px-4">
                    <div className="mb-6 md:mb-8 inline-block p-4 md:p-6 bg-white rounded-full shadow-2xl"><GraduationCap size={50} className="text-red-700 md:w-20 md:h-20" /></div>
                    <h1 className="text-3xl md:text-6xl font-extrabold text-gray-900 mb-2 md:mb-4 tracking-tight">{data.department.name}</h1>
                    <h2 className="text-lg md:text-3xl text-red-600 font-light mb-6 md:mb-8">{data.department.presentationTitle}</h2>
                    <p className="text-base md:text-xl text-gray-500 font-medium">{data.department.year}</p>
                  </div>
                </SlideContainer>

                <SlideContainer active={currentSlide === 1}>
                  <div className="w-full max-w-5xl px-4 pb-20 md:pb-0">
                    <h2 className="text-2xl md:text-4xl font-bold text-gray-800 mb-8 text-center border-b-2 border-red-100 pb-4">BÃ¶lÃ¼me Genel BakÄ±ÅŸ</h2>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                      <StatCard icon={Users} value={data.department.stats.studentCount} label="KayÄ±tlÄ± Ã–ÄŸrenci" color="bg-blue-500" />
                      <StatCard icon={Briefcase} value={data.department.stats.academicStaff} label="Akademik Personel" color="bg-red-500" />
                      <StatCard icon={BookOpen} value={data.department.stats.labCount} label="Laboratuvar" color="bg-green-500" />
                      <StatCard icon={Award} value={data.department.stats.foundedYear} label="KuruluÅŸ YÄ±lÄ±" color="bg-purple-500" />
                    </div>
                    <div className="bg-white rounded-2xl p-6 shadow-xl flex flex-col md:flex-row items-center gap-6">
                      <div className="flex-1 text-center md:text-left"><h3 className="text-xl font-bold mb-2 text-red-700">Vizyonumuz</h3><p className="text-sm text-gray-600">{data.department.vision}</p></div>
                      <div className="flex-1 text-center md:text-left"><h3 className="text-xl font-bold mb-2 text-gray-800">Misyonumuz</h3><p className="text-sm text-gray-600">{data.department.mission}</p></div>
                    </div>
                  </div>
                </SlideContainer>

                <SlideContainer active={currentSlide === 2}>
                  <div className="w-full max-w-6xl px-4 pb-20 md:pb-0">
                    <h2 className="text-2xl md:text-4xl font-bold text-gray-800 mb-2 text-center">Son 3 YÄ±l Akademik Performans</h2>
                    <p className="text-center text-gray-500 mb-8">(Otomatik HesaplanmÄ±ÅŸtÄ±r)</p>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                      <div className="bg-white p-4 rounded-xl shadow-lg border-t-4 border-blue-500"><h3 className="text-lg font-bold mb-4">Toplam YayÄ±n</h3>{data.department.performanceHistory.map((d) => <ProgressBar key={d.year} label={d.year} value={d.articles} max={Math.max(60, d.articles * 1.2)} colorClass="bg-blue-500" />)}</div>
                      <div className="bg-white p-4 rounded-xl shadow-lg border-t-4 border-green-500"><h3 className="text-lg font-bold mb-4">Toplam Proje</h3>{data.department.performanceHistory.map((d) => <ProgressBar key={d.year} label={d.year} value={d.projects} max={Math.max(20, d.projects * 1.2)} colorClass="bg-green-500" />)}</div>
                      <div className="bg-white p-4 rounded-xl shadow-lg border-t-4 border-yellow-500"><h3 className="text-lg font-bold mb-4">Toplam AtÄ±f (YÄ±llÄ±k)</h3>{data.department.performanceHistory.map((d) => <ProgressBar key={d.year} label={d.year} value={d.citations} max={Math.max(200, d.citations * 1.2)} colorClass="bg-yellow-500" />)}</div>
                    </div>
                  </div>
                </SlideContainer>

                 <SlideContainer active={currentSlide === 3}>
                  <div className="w-full max-w-6xl px-4 pb-20 md:pb-0">
                      <h2 className="text-2xl md:text-4xl font-bold text-gray-800 mb-6 text-center">DetaylÄ± YayÄ±n Ä°statistikleri</h2>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6 items-stretch">
                        <div className="bg-white p-5 rounded-2xl shadow-xl">
                            <h3 className="text-lg font-bold mb-4 text-gray-700">YayÄ±n TÃ¼rlerine GÃ¶re DaÄŸÄ±lÄ±m</h3>
                            {data.department.publicationStats.breakdown.map((type, idx) => (<ProgressBar key={idx} label={type.label} value={type.value} max={data.department.publicationStats.totalCount} colorClass={type.color} />))}
                            <div className="mt-4 text-center font-bold text-gray-500">Toplam: {data.department.publicationStats.totalCount}</div>
                        </div>
                        <div className="bg-white p-5 rounded-2xl shadow-xl flex flex-col">
                           <h3 className="text-lg font-bold mb-4 text-gray-700">YÄ±llara GÃ¶re YayÄ±n Trendi</h3>
                           <div className="flex-1 flex items-end justify-center w-full"><AreaChart data={data.department.publicationStats.yearlyTrend} /></div>
                        </div>
                      </div>
                  </div>
                </SlideContainer>

                <SlideContainer active={currentSlide === 4}>
                   <div className="w-full max-w-6xl px-4 pb-24 md:pb-0">
                      <h2 className="text-2xl md:text-4xl font-bold text-gray-800 mb-6 text-center">BÃ¶lÃ¼m Geneli Proje PortfÃ¶yÃ¼</h2>
                      <div className="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200">
                        <div className="overflow-x-auto">
                            <table className="w-full text-center border-collapse min-w-[600px]"><thead className="bg-gray-100 text-gray-600 text-xs md:text-sm uppercase tracking-wider"><th className="p-2 border-b">YÄ±l</th><th className="p-2 border-b bg-red-50 text-red-800">1001</th><th className="p-2 border-b bg-red-50 text-red-800">1002</th><th className="p-2 border-b bg-purple-50 text-purple-800">2209-A</th><th className="p-2 border-b bg-blue-50 text-blue-800">BAP</th><th className="p-2 border-b bg-yellow-50 text-yellow-800">COST</th><th className="p-2 border-b bg-green-50 text-green-800">SAYZEK</th><th className="p-2 border-b font-bold">TOPLAM</th></thead>
                              <tbody className="divide-y divide-gray-100 text-xs md:text-sm">{data.department.projectStats.map((row, idx) => (<tr key={idx} className="hover:bg-gray-50"><td className="p-2 font-bold">{row.year}</td><td className="p-2 bg-red-50/30">{row.t1001}</td><td className="p-2 bg-red-50/30">{row.t1002}</td><td className="p-2 bg-purple-50/30">{row.t2209}</td><td className="p-2 bg-blue-50/30">{row.bap}</td><td className="p-2 bg-yellow-50/30">{row.cost}</td><td className="p-2 bg-green-50/30 font-semibold">{row.sayzek}</td><td className="p-2 font-bold bg-gray-50">{row.total}</td></tr>))}</tbody>
                            </table>
                        </div>
                      </div>
                   </div>
                </SlideContainer>

                {data.faculty.map((person, index) => (
                  <SlideContainer key={person.id} active={currentSlide === staticSlidesCount + index}>
                    <div className="w-full max-w-6xl px-4 pb-24 md:pb-0 h-auto">
                      <div className="bg-white rounded-2xl shadow-xl overflow-hidden mb-4 md:mb-5 flex flex-col md:flex-row">
                        <div className="md:w-48 bg-gray-50 flex items-center justify-center p-6 md:p-0 border-r border-gray-100">
                          <div className="w-24 h-24 md:w-32 md:h-32 rounded-full bg-gray-200 border-4 border-white shadow-md overflow-hidden relative"><img src={person.image} alt={person.name} className="w-full h-full object-cover relative z-10" onError={(e) => {e.currentTarget.style.display='none'}} /><Users size={40} className="absolute inset-0 m-auto text-gray-400" /></div>
                        </div>
                        <div className="p-4 md:p-5 flex-1 flex flex-col justify-center">
                           <div className="flex flex-col md:flex-row justify-between items-start">
                                <div>
                                   <h2 className="text-xl md:text-3xl font-bold text-gray-800">{person.name}</h2>
                                   <p className="text-base md:text-xl text-red-600 font-medium mb-2">{person.title}</p>
                                   <div className="flex flex-wrap gap-2 mt-2"><MetricBadge label="H-Index" value={person.metrics.hIndex} icon={TrendingUp} color="bg-green-50 text-green-700" /><MetricBadge label="AtÄ±f" value={person.metrics.totalCitations} icon={Award} color="bg-blue-50 text-blue-700" /></div>
                                </div>
                                <div className="mt-4 md:mt-0 flex flex-col gap-2 items-start md:items-end">
                                    {person.email && <div className="flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-3 py-1 rounded-full"><Mail size={14}/> <a href={`mailto:${person.email}`} className="hover:text-blue-600 transition-colors">{person.email}</a></div>}
                                    {person.website && <div className="flex items-center gap-2 text-sm text-gray-600 bg-gray-50 px-3 py-1 rounded-full"><Globe size={14}/> <a href={`https://${person.website}`} target="_blank" rel="noreferrer" className="hover:text-blue-600 transition-colors">{person.website}</a></div>}
                                </div>
                           </div>
                        </div>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-5 h-auto md:h-[55vh]">
                        <div className="space-y-4 md:space-y-5 h-full md:overflow-y-auto pr-2">
                           <div className="bg-white p-4 rounded-xl shadow-md border border-gray-100"><h3 className="flex items-center gap-2 text-sm font-bold text-gray-800 mb-2 border-b pb-1"><Award size={18} className="text-purple-600"/> Ä°dari GÃ¶revler</h3><ul className="list-disc list-inside text-xs text-gray-600">{person.adminDuties.map((d, i) => <li key={i}>{d}</li>)}</ul></div>
                           <div className="bg-white p-4 rounded-xl shadow-md border border-gray-100"><h3 className="flex items-center gap-2 text-sm font-bold text-gray-800 mb-2 border-b pb-1"><GraduationCap size={18} className="text-red-600"/> Dersler</h3><div className="flex flex-wrap gap-2">{person.courses.map((c, i) => <span key={i} className="bg-gray-50 px-2 py-1 rounded text-[10px] border">{c}</span>)}</div></div>
                           <div className="bg-red-50 p-4 rounded-xl shadow-md border border-red-100"><h3 className="flex items-center gap-2 text-sm font-bold text-red-800 mb-2 border-b border-red-200 pb-1"><Target size={18} className="text-red-600"/> Hedefler</h3><ul className="space-y-1">{person.futureGoals.map((g, i) => <li key={i} className="flex gap-2 text-xs text-gray-700"><CheckCircle size={12} className="text-red-500"/>{g}</li>)}</ul></div>
                        </div>
                        <div className="bg-white p-4 md:p-6 rounded-xl shadow-md border border-gray-100 flex flex-col h-full md:overflow-y-auto gap-6">
                           <div><h3 className="flex items-center gap-2 text-sm font-bold text-gray-800 mb-3 border-b pb-2"><Briefcase className="text-green-600" size={20}/> Proje DaÄŸÄ±lÄ±mÄ± (Son 3 YÄ±l)</h3><div className="overflow-x-auto rounded-lg border border-gray-200"><table className="w-full text-center text-xs min-w-[300px]"><thead className="bg-gray-50 font-bold"><tr><th className="py-2">YÄ±l</th><th className="py-2">TÃœBÄ°TAK</th><th className="py-2">BAP</th><th className="py-2">COST</th><th className="py-2">SAYZEK</th><th className="py-2">DiÄŸer</th></tr></thead><tbody className="divide-y divide-gray-100">{person.projectsByYear.map((row, i) => (<tr key={i} className="hover:bg-gray-50"><td className="py-2 font-semibold">{row.year}</td><td className="py-2 text-green-700">{row.tubitak || '-'}</td><td className="py-2 text-blue-700">{row.bap || '-'}</td><td className="py-2 text-yellow-700">{row.cost || '-'}</td><td className="py-2 text-green-700 font-semibold">{row.sayzek || '-'}</td><td className="py-2 text-gray-400">{row.other || '-'}</td></tr>))}</tbody></table></div></div>
                           <div><h4 className="text-sm font-bold text-gray-800 mb-3 flex items-center gap-2 border-b border-red-100 pb-2"><Award size={20} className="text-red-500" /> TÃœBÄ°TAK YÄ±llÄ±k Detay</h4><div className="overflow-x-auto rounded-lg border border-red-100"><table className="w-full text-center text-xs min-w-[300px]"><thead className="bg-red-50 text-red-800 font-bold"><tr><th className="py-2">YÄ±l</th><th className="py-2">1001</th><th className="py-2">1002</th><th className="py-2">2209</th><th className="py-2">3501</th></tr></thead><tbody className="divide-y divide-red-50">{person.tubitakDetailsByYear.map((row, k) => (<tr key={k} className="hover:bg-red-50/50"><td className="py-2 font-semibold">{row.year}</td><td className="py-2">{row.t1001 || '-'}</td><td className="py-2">{row.t1002 || '-'}</td><td className="py-2">{row.t2209 || '-'}</td><td className="py-2">{row.t3501 || '-'}</td></tr>))}</tbody></table></div></div>
                           {person.yearlyPubs && person.yearlyPubs.length > 0 && (<div className="mt-auto pt-4 border-t border-gray-100"><h3 className="flex items-center gap-2 text-xs md:text-sm font-bold text-blue-800 mb-2"><BookOpen className="text-blue-600" size={16}/> YayÄ±n Ã–zeti (YÄ±l ve TÃ¼re GÃ¶re)</h3><div className="overflow-x-auto rounded-lg border border-blue-100"><table className="w-full text-center text-xs min-w-[300px]"><thead className="bg-blue-50 text-blue-800 font-bold"><tr><th className="py-1">YÄ±l</th><th className="py-1">SCI</th><th className="py-1">TR</th><th className="py-1">Bildiri</th><th className="py-1">Kitap</th></tr></thead><tbody className="divide-y divide-blue-50">{person.yearlyPubs.map((row, k) => (<tr key={k} className="hover:bg-blue-50/50"><td className="py-1 font-semibold text-gray-700">{row.year}</td><td className="py-1 text-gray-600">{row.sci || '-'}</td><td className="py-1 text-gray-600">{row.tr || '-'}</td><td className="py-1 text-gray-600">{row.conf || '-'}</td><td className="py-1 text-gray-600">{row.book || '-'}</td></tr>))}</tbody></table></div></div>)}
                        </div>
                      </div>
                    </div>
                  </SlideContainer>
                ))}
              </div>
              <div className="absolute bottom-4 right-4 md:bottom-8 md:right-8 flex gap-2 md:gap-4 z-50 no-print">
                <button onClick={prevSlide} disabled={currentSlide === 0} className="p-3 md:p-4 rounded-full bg-white text-gray-800 shadow-lg hover:bg-gray-50 border border-gray-200"><ChevronLeft size={20} /></button>
                <button onClick={nextSlide} disabled={currentSlide === totalSlides - 1} className="p-3 md:p-4 rounded-full bg-red-700 text-white shadow-lg hover:bg-red-800"><ChevronRight size={20} /></button>
              </div>
            </div>
          );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Presentation />);
    </script>
</body>
</html>